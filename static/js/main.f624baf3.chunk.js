(this.webpackJsonpfontanelle=this.webpackJsonpfontanelle||[]).push([[0],{191:function(e,t,n){},196:function(e,t,n){},197:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),i=n(22),c=n.n(i),s=n(64),r=n(65),l=n(72),u=n(71),h=n(66),d=n.n(h),p=n(3),b=n.n(p),j=n(4),f=n(23),g=n.n(f),m=n(67),v=n(5),O=n.n(v),w=n(68),x=n.n(w),k=(n(172),["drinking_water","toilets","shower"]),C=function(){var e=Object(m.a)(g.a.mark((function e(t){var n,a,o,i,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n='\n    [out:json];\n    (node["amenity"~"'.concat(k.join("|"),'"](around:').concat(t.around,",").concat(t.lat,",").concat(t.lng,"););\n    out;>;out;\n  "),"https://overpass.kumi.systems/api/interpreter",e.next=4,fetch("".concat("https://overpass.kumi.systems/api/interpreter","?data=").concat(n,"&output"));case 4:return a=e.sent,e.next=7,a.json();case 7:return o=e.sent,e.next=10,v.getItem("amenities");case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0=[];case 13:return i=e.t0,c=x()(o.elements.concat(i),(function(e){return e.id})),v.setItem("amenities",c),e.abrupt("return",o.elements);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=n(0),S=function(){return Object(y.jsxs)("svg",{width:"20px",height:"20px",viewBox:"0 0 508 508",enableBackground:"new 0 0 508 508",xmlSpace:"preserve",children:[Object(y.jsx)("circle",{fill:"#324A5E",cx:"254",cy:"254",r:"254"}),Object(y.jsx)("path",{fill:"#54C0EB",d:"M252,414h4c62.8,0,115.2-50.4,114-113.2c0-8-1.2-15.6-2.8-22.8C360,246.4,324,210,298,170.8  c-27.2-37.6-44-77.6-44-76.4c-0.4-0.8-17.2,39.2-44,76.4c-25.6,39.2-62,76-69.2,106.8c-2,7.2-2.8,14.8-2.8,22.8  C136.8,363.2,189.2,414,252,414z"}),Object(y.jsxs)("g",{children:[Object(y.jsx)("path",{fill:"#84DBFF",d:"M177.2,353.6c6-0.4,9.6-6,7.2-10.8c-3.2-7.2-6-14.8-7.2-22.8c-1.6-8-2-15.6-1.6-23.2   c1.2-32,32-75.2,51.6-118.4c2-3.6,3.6-7.6,5.2-11.2c-0.8,1.2-1.6,2.4-2.4,3.2c-26.4,40.4-64,78.8-70.8,110   c-1.6,7.2-2.4,15.2-2.4,23.2c0.4,16.8,4.8,32,12.4,46C171.2,352.4,174,354,177.2,353.6L177.2,353.6z"}),Object(y.jsx)("ellipse",{transform:"matrix(-0.042 -0.9991 0.9991 -0.042 -169.3631 569.6013)",fill:"#84DBFF",cx:"188.401",cy:"365.998",rx:"8.4",ry:"9.2"})]})]})},A=function(e){return Object(y.jsx)("svg",{width:"20px",height:"20px",viewBox:"0 0 395 395",xmlSpace:"preserve",fill:"black",style:{background:e.color||"white",borderRadius:3},children:Object(y.jsxs)("g",{children:[Object(y.jsx)("path",{d:"M229.412,130.862c-2.405-3.355-6.284-5.346-10.412-5.346h-1.266c-5.524,0-10.424,3.539-12.161,8.782l-27.534,83.09   l-27.662-83.107c-1.743-5.233-6.639-8.765-12.156-8.765h-0.822c-0.051,0-0.104,0.003-0.153,0.003c-0.053,0-0.105-0.003-0.155-0.003   h-0.998c-5.524,0-10.425,3.539-12.163,8.782l-27.533,83.09l-27.661-83.107c-1.742-5.233-6.64-8.765-12.156-8.765h-1.268   c-4.13,0-8.007,1.991-10.414,5.346c-2.407,3.357-3.045,7.669-1.72,11.579l40.125,118.344c1.763,5.201,6.643,8.698,12.135,8.698   h0.53c0.153,0,0.303-0.008,0.455-0.014c0.151,0.006,0.302,0.014,0.454,0.014h0.354c5.5,0,10.386-3.511,12.142-8.721l27.845-82.675   l27.718,82.657c1.751,5.221,6.642,8.739,12.148,8.739h0.527c0.153,0,0.303-0.008,0.456-0.014c0.15,0.006,0.302,0.014,0.454,0.014   h0.355c5.491,0,10.37-3.497,12.134-8.698l40.125-118.344C232.459,138.531,231.818,134.22,229.412,130.862z"}),Object(y.jsx)("path",{d:"M347.88,232.295c-4.756-4.416-12.063-4.578-17.01-0.378c-8.521,7.234-19.511,11.218-30.943,11.218   c-26.069,0-47.277-20.51-47.277-45.721c0-25.116,21.208-45.548,47.277-45.548c11.542,0,22.522,3.916,30.921,11.027   c5.087,4.306,12.625,3.995,17.339-0.719l0.427-0.427c2.544-2.542,3.899-6.036,3.74-9.628c-0.161-3.592-1.822-6.952-4.58-9.258   c-13.371-11.184-30.366-17.344-47.848-17.344c-40.598,0-73.628,32.253-73.628,71.898c0,39.739,33.03,72.07,73.628,72.07   c17.454,0,34.493-6.207,47.979-17.48c2.822-2.36,4.495-5.817,4.589-9.494c0.098-3.678-1.393-7.22-4.087-9.723L347.88,232.295z"}),Object(y.jsx)("path",{d:"M313.001,0H81.999C36.785,0,0,36.784,0,81.998v230.993C0,358.211,36.785,395,81.999,395h231.002   C358.216,395,395,358.211,395,312.991V81.998C395,36.784,358.216,0,313.001,0z M380,312.991C380,349.94,349.945,380,313.001,380   H81.999C45.056,380,15,349.94,15,312.991V81.998C15,45.055,45.056,15,81.999,15h231.002C349.945,15,380,45.055,380,81.998V312.991z   "})]})})},M=function(e){return Object(y.jsx)("svg",{enableBackground:"new -0.258 -0.548 123.547 123.539",xmlSpace:"preserve",viewBox:"-0.258 -0.548 123.547 123.539",width:"20px",height:"20px",children:Object(y.jsxs)("g",{children:[Object(y.jsx)("path",{fill:"#231F20",d:"m109.63 123.6c8.148 0 14.766-6.586 14.766-14.742v-94.02c0-8.156-6.617-14.773-14.766-14.773h-94.013c-8.156 0-14.758 6.617-14.758 14.773v94.016c0 8.156 6.602 14.742 14.758 14.742h94.013z"}),Object(y.jsx)("path",{fill:e.color,d:"m15.617 2.559c-6.758 0-12.258 5.516-12.258 12.281v94.016c0 6.734 5.5 12.234 12.258 12.234h94.016c6.758 0 12.25-5.5 12.25-12.234v-94.02c0-6.766-5.492-12.281-12.25-12.281h-94.013z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m68.344 66.402c6.789 0 12.281-5.5 12.281-12.281 0-6.789-5.492-12.281-12.281-12.281s-12.297 5.492-12.297 12.281c0 6.781 5.508 12.281 12.297 12.281z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m56.766 96.254c0 1.32 1.062 3.055 2.398 3.055v-0.023h5.664v0.023c1.344 0 3.055-1.711 3.055-3.031v-10.446c0-1.32-1.711-3-3.055-3h-5.664c-1.25 0-2.266 1.586-2.398 2.781 8.164 0 8.109 10.641 0 10.641zm-5.149-25.922c1.312-1.273 3.102-2.031 5.055-2.031h24.219l24.367-24.438c5.227-5.25 12.062 1.562 6.836 6.812l-26.741 26.805 0.023 36.602h-32.062v-17.771h-14.484c-3.016 0-5.469-2.445-5.469-5.469 0-1.297 0.438-2.469 1.18-3.422l17.07-17.086z"}),Object(y.jsx)("polygon",{fill:"#231F20",points:"12.883 22.621 15.859 25.605 30.242 10.902 27.266 7.926 20.742 10.395 17.75 7.418 11.75 13.395 14.727 16.402"}),Object(y.jsx)("path",{fill:"#231F20",d:"m35.023 69.324c-0.281 1.812 0.969 3.445 2.734 3.688 1.781 0.297 3.469-1 3.688-2.734 0.273-1.805-0.953-3.438-2.742-3.688-1.773-0.266-3.445 0.953-3.68 2.734z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m37.844 61.902c0.242-1.703-0.914-3.266-2.609-3.516-1.695-0.242-3.258 0.93-3.508 2.617-0.242 1.734 0.93 3.242 2.617 3.492 1.679 0.267 3.273-0.929 3.5-2.593z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m34.242 53.535c0.219-1.617-0.867-3.102-2.477-3.352-1.609-0.219-3.086 0.883-3.32 2.492-0.234 1.641 0.867 3.078 2.469 3.32 1.609 0.275 3.109-0.897 3.328-2.46z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m30.641 45.16c0.219-1.516-0.812-2.93-2.344-3.148-1.539-0.219-2.93 0.828-3.148 2.344-0.219 1.531 0.828 2.906 2.344 3.148s2.945-0.859 3.148-2.344z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m27.039 36.785c0.211-1.445-0.781-2.781-2.203-2.977-1.453-0.195-2.766 0.781-2.969 2.219-0.211 1.469 0.766 2.734 2.195 2.977 1.446 0.219 2.782-0.805 2.977-2.219z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m18.57 27.699c-0.211 1.367 0.734 2.562 2.078 2.789 1.344 0.219 2.594-0.758 2.789-2.078 0.195-1.344-0.727-2.609-2.07-2.781-1.383-0.195-2.617 0.726-2.797 2.07z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m47.148 57.512c0.086-1.758 1.602-3.148 3.367-3.055 1.781 0.102 3.141 1.586 3.055 3.398-0.062 1.781-1.586 3.125-3.375 3.023-1.765-0.046-3.148-1.562-3.047-3.366z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m45.117 54.02c-1.68-0.07-3-1.492-2.898-3.219 0.086-1.688 1.523-2.984 3.211-2.906 1.695 0.094 2.977 1.508 2.898 3.219-0.07 1.71-1.508 2.976-3.211 2.906z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m40.055 47.137c-1.602-0.078-2.844-1.414-2.758-3.031 0.086-1.609 1.438-2.852 3.055-2.758 1.594 0.078 2.828 1.445 2.758 3.055-0.063 1.585-1.446 2.827-3.055 2.734z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m34.977 40.277c-1.516-0.078-2.695-1.344-2.609-2.883 0.086-1.516 1.367-2.688 2.891-2.609 1.516 0.07 2.688 1.367 2.609 2.875-0.056 1.516-1.368 2.711-2.891 2.617z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m29.914 33.418c-1.43-0.078-2.555-1.297-2.469-2.734 0.07-1.422 1.281-2.516 2.719-2.469 1.43 0.07 2.539 1.297 2.469 2.734-0.063 1.414-1.297 2.539-2.719 2.469z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m22.516 23.988c0.07-1.336 1.203-2.391 2.562-2.32 1.344 0.055 2.391 1.203 2.32 2.547-0.062 1.336-1.227 2.414-2.562 2.312-1.344-0.07-2.398-1.195-2.32-2.539z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m55.945 43.691c-1.781 0.102-3.328-1.266-3.391-3.047-0.094-1.812 1.305-3.32 3.086-3.398 1.75-0.07 3.281 1.273 3.352 3.102 0.102 1.734-1.258 3.273-3.047 3.343z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m52.078 35.27c0.086 1.633-1.18 3.055-2.859 3.125-1.672 0.07-3.109-1.195-3.18-2.852-0.078-1.688 1.219-3.078 2.891-3.18 1.648-0.07 3.062 1.196 3.148 2.907z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m45.172 30.191c0.07 1.539-1.125 2.859-2.688 2.93-1.562 0.078-2.914-1.125-2.977-2.656-0.078-1.594 1.148-2.906 2.711-2.984 1.532-0.071 2.868 1.124 2.954 2.71z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m38.258 25.113c0.062 1.445-1.047 2.688-2.5 2.734-1.453 0.07-2.711-1.047-2.773-2.492-0.055-1.461 1.078-2.68 2.531-2.758 1.429-0.07 2.672 1.055 2.742 2.516z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m26.469 20.277c-0.07-1.367 0.992-2.516 2.328-2.562 1.336-0.07 2.492 0.977 2.555 2.32s-0.977 2.492-2.32 2.539c-1.344 0.078-2.516-0.976-2.563-2.297z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m32.508 13.762c1.336-0.195 2.602 0.734 2.797 2.078s-0.734 2.609-2.086 2.781c-1.344 0.219-2.602-0.734-2.797-2.078-0.18-1.344 0.758-2.586 2.086-2.781z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m44.117 19.426c0.211 1.414-0.781 2.734-2.195 2.93-1.414 0.219-2.742-0.781-2.938-2.172-0.195-1.414 0.789-2.758 2.195-2.953 1.399-0.196 2.735 0.781 2.938 2.195z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m52.93 22.988c0.227 1.516-0.812 2.883-2.305 3.102-1.484 0.219-2.891-0.828-3.102-2.297-0.203-1.484 0.836-2.875 2.312-3.094 1.477-0.226 2.876 0.805 3.095 2.289z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m61.727 26.582c0.25 1.562-0.852 3-2.414 3.242-1.547 0.219-3.023-0.852-3.227-2.414-0.227-1.562 0.852-3.031 2.398-3.25 1.563-0.242 3.024 0.86 3.243 2.422z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m70.539 30.168c0.25 1.633-0.898 3.148-2.516 3.391-1.633 0.25-3.172-0.898-3.391-2.516-0.219-1.633 0.906-3.172 2.516-3.414 1.633-0.219 3.149 0.906 3.391 2.539z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m79.352 33.754c0.273 1.711-0.922 3.297-2.633 3.539-1.688 0.25-3.297-0.945-3.539-2.633-0.242-1.711 0.93-3.32 2.633-3.562 1.71-0.243 3.296 0.953 3.539 2.656z"}),Object(y.jsx)("path",{fill:"#231F20",d:"m84.484 34.559c1.781-0.242 3.438 1.008 3.688 2.789 0.266 1.758-0.977 3.414-2.734 3.688-1.789 0.266-3.469-0.977-3.688-2.758-0.273-1.79 0.953-3.446 2.734-3.719z"})]})})},z=n(36),N=function(){return Object(y.jsx)("svg",{fill:"#000000",viewBox:"0 0 30 30",width:"20px",height:"20px",children:Object(y.jsx)("path",{d:"M 3 7 A 1.0001 1.0001 0 1 0 3 9 L 27 9 A 1.0001 1.0001 0 1 0 27 7 L 3 7 z M 3 14 A 1.0001 1.0001 0 1 0 3 16 L 27 16 A 1.0001 1.0001 0 1 0 27 14 L 3 14 z M 3 21 A 1.0001 1.0001 0 1 0 3 23 L 27 23 A 1.0001 1.0001 0 1 0 27 21 L 3 21 z"})})},F=n(69),T=n(70),R=function(e){return Object(y.jsx)(b.a,{className:"popup",style:{display:e.isOpen?"flex":"none"},hAlignContent:"center",vAlignContent:"center",onClick:function(t){t.stopPropagation(),e.onClose()},shrink:!1,children:Object(y.jsx)(b.a,{className:"popup-content",column:!0,onClick:function(e){e.stopPropagation()},children:e.children})})},B=n(24),I=n(2),W=n(6),L=n(35),D=function(e){return Object(y.jsxs)(b.a,{column:!0,className:"select",shrink:!1,children:[Object(y.jsx)("span",{className:"select-label",children:e.label}),Object(y.jsx)("select",{value:e.value,onChange:function(t){return e.onChange(t.currentTarget.value)},children:e.options.map((function(e){return Object(y.jsx)("option",{value:e.value,children:e.label},e.value)}))})]})},E=function(e){return Object(y.jsxs)(b.a,{column:!0,className:"input",shrink:!1,children:[Object(y.jsx)("span",{className:"input-label",children:e.label}),Object(y.jsx)("input",{value:e.value,onChange:function(t){return e.onChange(t.currentTarget.value)}})]})},P=function(e){var t=a.useState(Object(I.a)({},e.node)),n=Object(W.a)(t,2),o=n[0],i=n[1],c=function(e,t){i(Object(I.a)(Object(I.a)({},o),{},{tags:Object(I.a)(Object(I.a)({},o.tags),{},Object(B.a)({},e,t))}))};return L.isLoggedIn()?Object(y.jsxs)(R,{onClose:e.onClose,isOpen:!0,children:[Object(y.jsx)("h2",{children:function(){switch(e.node.tags.amenity){case"drinking_water":return"Drinking Water";case"toilets":return"Toilets";case"shower":return"Shower"}}()}),Object(y.jsxs)(b.a,{column:!0,shrink:!1,children:[("toilets"===o.tags.amenity||"shower"===o.tags.amenity)&&Object(y.jsx)(D,{value:o.tags.access,label:"Access",onChange:function(e){return c("access",e)},options:[{value:"unknown",label:"Unknown"},{value:"yes",label:"Yes"},{value:"public",label:"Public"},{value:"permissive",label:"Permissive"}]}),("toilets"===o.tags.amenity||"shower"===o.tags.amenity)&&Object(y.jsx)(D,{value:o.tags.fee,label:"Fee",onChange:function(e){return c("fee",e)},options:[{value:"unknown",label:"Unknown"},{value:"yes",label:"Yes"},{value:"no",label:"No"}]}),"toilets"!==o.tags.amenity&&"shower"!==o.tags.amenity||"yes"!==o.tags.fee?Object(y.jsx)("div",{}):Object(y.jsx)(E,{value:o.tags.charge,label:"Fee Amount",onChange:function(e){return c("charge",e)}}),"toilets"===o.tags.amenity&&Object(y.jsx)(D,{value:o.tags.unisex,label:"Gender",onChange:function(e){return c("unisex",e)},options:[{value:"yes",label:"Yes"},{value:"male",label:"Male"},{value:"female",label:"Female"}]}),"toilets"===o.tags.amenity&&Object(y.jsx)(D,{value:o.tags.changing_table,label:"Changing Table",onChange:function(e){return c("changing_table",e)},options:[{value:"unknown",label:"Unknown"},{value:"yes",label:"Yes"},{value:"no",label:"No"}]}),"shower"===o.tags.amenity&&Object(y.jsx)(D,{value:o.tags.hot_water,label:"Hot Water",onChange:function(e){return c("hot_water",e)},options:[{value:"unknown",label:"Unknown"},{value:"yes",label:"Yes"},{value:"no",label:"No"}]}),("toilets"===o.tags.amenity||"shower"===o.tags.amenity)&&Object(y.jsx)(D,{value:o.tags.wheelchair,label:"Wheelchair",onChange:function(e){return c("wheelchair",e)},options:[{value:"unknown",label:"Unknown"},{value:"yes",label:"Yes"},{value:"no",label:"No"},{value:"limited",label:"Limited"}]})]}),Object(y.jsx)("button",{style:{marginTop:48,height:40,width:200,marginLeft:"auto",flexShrink:0},children:"Save on OSM"})]}):Object(y.jsxs)(R,{onClose:e.onClose,isOpen:!0,children:[Object(y.jsx)("h2",{children:"You need to be logged into Open Street Maps to add and edit nodes"}),Object(y.jsx)("button",{style:{marginTop:48,height:40,width:200,marginLeft:"auto",flexShrink:0},onClick:function(){L.login({mode:"popup",clientId:"UzKLAo2Jaaq3uuekbiMxIBX4NQQk5NrVwqMtKZZT7tA",redirectUrl:"https://francescocioria.github.io/fontanelle/",scopes:["write_api"]})},children:"Log in OSM"})]})},U=(n(191),function(e){return Object(y.jsxs)(b.a,{className:"checkbox",vAlignContent:"center",onClick:function(){return e.onChange(!e.value)},children:[Object(y.jsx)("input",{checked:e.value,type:"checkbox",onChange:function(t){e.onChange(t.currentTarget.checked)}}),Object(y.jsx)("span",{className:"checkbox-label",children:e.label})]})}),_=window.mapboxgl,Y=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,c=new Array(o),r=0;r<o;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={upsertNode:null,isMenuOpen:!1,around:0,showRadius:!1,showDrinkingWater:!0,showShowers:!0,showToilets:!0,continousSearch:!1,showSearchThisAreaButton:!1},e.map=j.none,e.circleRadius=null,e.drinkingWaterNodes={},e.drinkingWaterMarkers=[],e.publicToiletsNodes={},e.publicToiletsMarkers=[],e.publicShowersNodes={},e.publicShowersMarkers=[],e.loadingBarRef=a.createRef(),e.previousCenter={lng:0,lat:0},e.updateAmenities=function(){Object(j.map)((function(t){O.a.getItem("amenities").then((function(n){n&&e.addAmenitiesMarkers(n.filter((function(n){return Object(z.a)([t.getCenter().lat,t.getCenter().lng],[n.lat,n.lon],{units:"meters"})<e.state.around})))})),e.loadingBarRef.current&&e.loadingBarRef.current.continuousStart(),C({around:e.state.around,lat:t.getCenter().lat,lng:t.getCenter().lng}).then(e.addAmenitiesMarkers).then((function(){e.loadingBarRef.current&&e.loadingBarRef.current.complete()}))}))(e.map)},e.updateAmenitiesDebounce=d()((function(){Object(j.map)((function(t){0!==e.previousCenter.lat||0!==e.previousCenter.lng?Object(z.a)([t.getCenter().lat,t.getCenter().lng],[e.previousCenter.lat,e.previousCenter.lng],{units:"meters"})>e.state.around/2?e.state.continousSearch?(e.previousCenter=t.getCenter(),e.updateAmenities()):e.setState({showSearchThisAreaButton:!0}):e.setState({showSearchThisAreaButton:!1}):e.previousCenter=t.getCenter()}))(e.map)}),1e3),e.addMarkers=function(t,n,a,o,c){Object(j.map)((function(e){t.forEach((function(t){if(!n[t.id]){var s=document.createElement("div");i.render(a(t),s);var r=new _.Marker({element:s}).setLngLat([t.lon,t.lat]),l=new _.Popup({offset:25}).setHTML('<div style="overflow-wrap: break-word;">\n                '.concat(Object.keys(t.tags).map((function(e){return"<b>".concat(e,":</b> ").concat(t.tags[e])})).join("<br />"),"\n\n                ").concat(t.tags.mapillary?'<button style="margin-top: 16px;">\n                        <a href="'.concat(t.tags.mapillary,'" target="_blank" rel="noopener noreferrer">\n                          See street view\n                        </a>\n                      </button>'):"",'\n\n                <div>\n                  <button style="margin-top: 16px;">\n                    <a href="https://www.google.com/maps/dir//').concat(t.lat,",").concat(t.lon,'" target="_blank" rel="noopener noreferrer">\n                      Directions\n                    </a>\n                  </button>\n                </div>\n\n                <div>\n                  <button style="margin-top: 16px;" onclick="editNode(\'').concat(t.id,"')\">\n                    Edit node\n                  </button>\n                </div>\n              </div>\n              "));r.setPopup(l),c&&r.addTo(e),n[t.id]=t,o.push(r)}}))}))(e.map)},e.addAmenitiesMarkers=function(t){e.addMarkers(t.filter((function(e){return"shower"===e.tags.amenity})),e.publicShowersNodes,(function(t){return Object(y.jsx)(M,{color:e.color(t.tags)})}),e.publicShowersMarkers,e.state.showShowers),e.addMarkers(t.filter((function(e){return"drinking_water"===e.tags.amenity})),e.drinkingWaterNodes,(function(){return Object(y.jsx)(S,{})}),e.drinkingWaterMarkers,e.state.showDrinkingWater),e.addMarkers(t.filter((function(e){return"toilets"===e.tags.amenity})),e.publicToiletsNodes,(function(t){return Object(y.jsx)(A,{color:e.color(t.tags)})}),e.publicToiletsMarkers,e.state.showToilets)},e}return Object(r.a)(n,[{key:"initializeMap",value:function(){var e=this;_.accessToken="pk.eyJ1IjoiZnJhbmNlc2NvY2lvcmlhIiwiYSI6ImNqcThyejR6ODA2ZDk0M25rZzZjcGo4ZmcifQ.yRWHQbG1dJjDp43d01bBOw",navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){var n=new _.Map({container:"map",style:"mapbox://styles/francescocioria/cjqi3u6lmame92rmw6aw3uyhm?optimize=true",center:{lat:t.coords.latitude,lng:t.coords.longitude},zoom:15,scrollZoom:!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)});n.addControl(new _.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"bottom-right"),n.addControl(new _.NavigationControl({showZoom:!1,showCompass:!0}),"bottom-right"),n.addControl(new _.ScaleControl),n.on("load",(function(){var t;e.map=Object(j.some)(n),e.updateAmenities(),null===(t=document.querySelector(".mapboxgl-ctrl-geolocate"))||void 0===t||t.click()})),n.on("move",(function(){e.updateAmenitiesDebounce(),requestAnimationFrame((function(){e.state.showRadius&&e.showRadius()}))}))}))}},{key:"color",value:function(e){return"access"in e&&e.access&&!["yes","public","unknown","permissive"].includes(e.access)?"#d0d0d0":"fee"in e&&"string"===typeof e.fee&&"no"!==e.fee?"gold":"white"}},{key:"showRadius",value:function(){var e=this;Object(j.map)((function(t){var n={lat:t.getCenter().lat,lng:t.getCenter().lng};e.circleRadius?(e.circleRadius.setCenter(n),e.circleRadius.setRadius(e.state.around)):e.circleRadius=new F(n,e.state.around,{editable:!1,minRadius:0,fillColor:"transparent"}).addTo(t)}))(this.map)}},{key:"hideRadius",value:function(){this.circleRadius.remove(),this.circleRadius=null}},{key:"componentDidMount",value:function(){var e=this;O.a.getItem("around").then((function(t){return e.setState({around:t||1e3})})),O.a.getItem("showRadius").then((function(t){e.setState({showRadius:null===t||t}),t&&e.showRadius()})),O.a.getItem("continousSearch").then((function(t){return e.setState({continousSearch:t||!1})})),this.initializeMap(),window.editNode=function(t){O.a.getItem("amenities").then((function(n){var a=null===n||void 0===n?void 0:n.find((function(e){return String(e.id)===t}));e.setState({upsertNode:a||null})}))}}},{key:"componentDidUpdate",value:function(){var e=this;requestAnimationFrame((function(){Object(j.map)((function(e){return e.resize()}))(e.map)}))}},{key:"render",value:function(){var e=this;return Object(y.jsxs)(b.a,{style:{height:"100%",width:"100%"},column:!0,children:[Object(y.jsx)(b.a,{children:Object(y.jsx)(T.a,{ref:this.loadingBarRef,color:"lightgreen",height:8})}),Object(y.jsx)(b.a,{grow:!0,id:"map"}),this.state.showSearchThisAreaButton&&Object(y.jsx)(b.a,{className:"search-this-area-button",vAlignContent:"center",hAlignContent:"center",onClick:function(){Object(j.map)((function(t){e.previousCenter=t.getCenter(),e.updateAmenities(),e.setState({showSearchThisAreaButton:!1})}))(e.map)},children:"Search this area"}),this.state.upsertNode&&Object(y.jsx)(P,{onClose:function(){e.setState({upsertNode:null})},node:this.state.upsertNode}),Object(y.jsxs)(b.a,{className:"menu-button",hAlignContent:"center",vAlignContent:"center",onClick:function(){return e.setState({isMenuOpen:!0})},children:[Object(y.jsx)(N,{}),Object(y.jsxs)(R,{onClose:function(){e.setState({isMenuOpen:!1})},isOpen:this.state.isMenuOpen,children:[Object(y.jsxs)("span",{className:"menu-item-label",children:["Around radius: ",Object(y.jsxs)("b",{children:[this.state.around," meters"]})]}),Object(y.jsx)("input",{value:this.state.around,type:"range",min:"500",max:"15000",step:"500",onChange:function(t){var n=parseInt(t.currentTarget.value)||1e3;e.setState({around:n}),O.a.setItem("around",n)}}),Object(y.jsx)(b.a,{height:24}),Object(y.jsx)(b.a,{className:"separator"}),Object(y.jsx)(U,{value:this.state.showRadius,label:"Show radius in map",onChange:function(t){e.setState({showRadius:t}),O.a.setItem("showRadius",t),t?e.showRadius():e.hideRadius()}}),Object(y.jsx)(b.a,{className:"separator"}),Object(y.jsx)(U,{value:this.state.continousSearch,label:"Enable continous search",onChange:function(t){e.setState({continousSearch:t,showSearchThisAreaButton:!1}),O.a.setItem("continousSearch",t)}}),Object(y.jsx)(b.a,{className:"separator"}),Object(y.jsx)(U,{value:this.state.showDrinkingWater,label:'Show "drinking water"',onChange:function(t){e.setState({showDrinkingWater:t}),Object(j.map)((function(n){t?e.drinkingWaterMarkers.forEach((function(e){return e.addTo(n)})):e.drinkingWaterMarkers.forEach((function(e){return e.remove()}))}))(e.map)}}),Object(y.jsx)(U,{value:this.state.showToilets,label:'Show "toilets"',onChange:function(t){e.setState({showToilets:t}),Object(j.map)((function(n){t?e.publicToiletsMarkers.forEach((function(e){return e.addTo(n)})):e.publicToiletsMarkers.forEach((function(e){return e.remove()}))}))(e.map)}}),Object(y.jsx)(U,{value:this.state.showShowers,label:'Show "showers"',onChange:function(t){e.setState({showShowers:t}),Object(j.map)((function(n){t?e.publicShowersMarkers.forEach((function(e){return e.addTo(n)})):e.publicShowersMarkers.forEach((function(e){return e.remove()}))}))(e.map)}})]})]})]})}}]),n}(a.PureComponent),Z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function q(e){if("serviceWorker"in navigator){if(new URL("/fontanelle",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/fontanelle","/service-worker.js");Z?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):H(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):H(t,e)}))}}function H(e,t){navigator.serviceWorker.register(e,{scope:"/fontanelle/"}).then((function(e){console.log(e.scope),e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var J=function(){var e=o.a.useState(!1),t=Object(W.a)(e,2),n=t[0],i=t[1],c=o.a.useState(j.none),s=Object(W.a)(c,2),r=s[0],l=s[1],u=function(e){i(!0),l(Object(j.fromNullable)(e.waiting))};Object(a.useEffect)((function(){q({onUpdate:u})}),[]);return n?Object(y.jsxs)(b.a,{className:"updateAvailable",vAlignContent:"center",hAlignContent:"center",style:{background:"lightgreen",height:40,color:"black",position:"fixed",bottom:0,left:0,right:0,zIndex:9999999999999},children:["Update Available:",Object(y.jsx)("span",{style:{marginLeft:32,textDecoration:"underline",cursor:"pointer"},onClick:function(){return console.log("reload page"),Object(j.map)((function(e){return e.postMessage({type:"SKIP_WAITING"})}))(r),i(!1),void window.location.reload()},children:"Install"}),Object(y.jsx)("span",{style:{marginLeft:32,textDecoration:"underline",cursor:"pointer"},onClick:function(){console.log("ignore"),i(!1)},children:"Ignore"})]}):null};var G=function(){return Object(y.jsxs)(b.a,{className:"App",style:{height:"100vh",width:"100vw"},column:!0,children:[Object(y.jsx)(J,{}),Object(y.jsx)(Y,{})]})};n(196);c.a.render(Object(y.jsx)(o.a.StrictMode,{children:Object(y.jsx)(G,{})}),document.getElementById("root"))}},[[197,1,2]]]);
//# sourceMappingURL=main.f624baf3.chunk.js.map